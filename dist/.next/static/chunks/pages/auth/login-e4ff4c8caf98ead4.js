(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[344],{163:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/login",function(){return r(7468)}])},4613:function(e,s,r){"use strict";r.d(s,{Z:function(){return a}});var t=r(5893),i=r(5378),n=r.n(i);function a(e){let{children:s,title:r="ProAutoServices"}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n(),{children:[(0,t.jsx)("title",{children:r}),(0,t.jsx)("meta",{name:"description",content:"Application de gestion de garage automobile"}),(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsx)("main",{children:s})]})}},9008:function(e,s,r){"use strict";r.d(s,{O:function(){return t}});let t=(0,r(6490).eI)("https://pjxtjkmqgkbisgfleaps.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBqeHRqa21xZ2tiaXNnZmxlYXBzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYxOTAzMzAsImV4cCI6MjA1MTc2NjMzMH0.UjKK4kSJDapIRx0iJvdHiJZzMbi99tDx52FmSq4qyfE",{auth:{persistSession:!0,autoRefreshToken:!0}})},7468:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return o}});var t=r(5893),i=r(7294),n=r(1163),a=r(9008),l=r(4613);function o(){let[e,s]=(0,i.useState)(!1),[r,o]=(0,i.useState)(""),d=(0,n.useRouter)(),c=async e=>{e.preventDefault();let r=e.currentTarget,t=r.elements.namedItem("email").value,i=r.elements.namedItem("password").value;try{s(!0),o("");let{data:e,error:r}=await a.O.auth.signInWithPassword({email:t,password:i});if(r)throw r;let{data:l,error:c}=await a.O.from("users").select("*").eq("id",e.user.id).single();if(c&&"PGRST116"!==c.code)throw c;if(!l){var n;let{error:s}=await a.O.from("users").insert([{id:e.user.id,email:e.user.email,role:"admin",full_name:(null===(n=e.user.email)||void 0===n?void 0:n.split("@")[0])||"User"}]).single();if(s)throw s}let{data:m,error:u}=await a.O.from("users").select("role").eq("id",e.user.id).single();if(u)throw u;"admin"===m.role?d.push("/admin/dashboard"):"secretary"===m.role?d.push("/secretary/dashboard"):"mechanic"===m.role&&d.push("/mechanic/dashboard")}catch(e){console.error("Error logging in:",e),o(e.message||"Une erreur est survenue lors de la connexion")}finally{s(!1)}};return(0,t.jsx)(l.Z,{title:"Connexion - ProAutoServices",children:(0,t.jsxs)("div",{className:"min-h-screen flex flex-col justify-center py-12 sm:px-6 lg:px-8 bg-gray-50",children:[(0,t.jsx)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:(0,t.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Connexion \xe0 votre compte"})}),(0,t.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,t.jsxs)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[r&&(0,t.jsx)("div",{className:"rounded-md bg-red-50 p-4 mb-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Erreur"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,t.jsx)("p",{children:r})})]})]})}),(0,t.jsxs)("form",{className:"space-y-6",onSubmit:c,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Adresse email"}),(0,t.jsx)("div",{className:"mt-1",children:(0,t.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Mot de passe"}),(0,t.jsx)("div",{className:"mt-1",children:(0,t.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{type:"submit",disabled:e,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:e?"Connexion...":"Se connecter"})})]})]})})]})})}},5378:function(e,s,r){e.exports=r(4764)}},function(e){e.O(0,[574,774,888,179],function(){return e(e.s=163)}),_N_E=e.O()}]);