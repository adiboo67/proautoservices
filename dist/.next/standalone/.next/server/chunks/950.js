exports.id=950,exports.ids=[950],exports.modules={4494:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(997);function a(){return r.jsx("div",{className:"flex justify-center items-center p-4",children:r.jsx("img",{src:"/images/mechanic-duck.png.png",alt:"M\xe9canicien",className:"w-48 h-48 object-contain",style:{maxWidth:"100%",height:"auto"}})})}},6530:(e,s,t)=>{"use strict";t.d(s,{Z:()=>o});var r=t(997),a=t(6689),l=t(1163),i=t(9008);function o({children:e,allowedRoles:s}){let t=(0,l.useRouter)(),[o,n]=(0,a.useState)(!0);async function c(){try{let{data:{session:e}}=await i.O.auth.getSession();if(!e){t.push("/auth/login");return}if(s){let{data:r}=await i.O.from("users").select("role").eq("id",e.user.id).single();if(!r||!s.includes(r.role)){t.push("/");return}}}catch(e){console.error("Error checking auth:",e),t.push("/auth/login")}finally{n(!1)}}return((0,a.useEffect)(()=>{c()},[]),o)?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):r.jsx(r.Fragment,{children:e})}},34:(e,s,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(s,{Z:()=>u});var a=t(997),l=t(6689),i=t(1163),o=t(9008),n=t(3590),c=t(4494),d=e([n]);function u({children:e,title:s}){let t=(0,i.useRouter)(),[r,d]=(0,l.useState)(!1),[u,m]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{let{data:{user:e}}=await o.O.auth.getUser();if(e){let{data:s,error:t}=await o.O.from("users").select("full_name").eq("id",e.id).single();s&&s.full_name?m(s.full_name):m(e.email||null)}})()},[]);let h=async()=>{try{let{error:e}=await o.O.auth.signOut();if(e)throw e;t.push("/auth/login"),n.toast.success("D\xe9connexion r\xe9ussie")}catch(e){n.toast.error("Erreur lors de la d\xe9connexion"),console.error("Error:",e)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[a.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform ${r?"translate-x-0":"-translate-x-full"} lg:translate-x-0 transition-transform duration-200 ease-in-out`,children:(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[a.jsx("div",{className:"flex items-center justify-center h-16 px-4 bg-blue-600",children:a.jsx("h2",{className:"text-xl font-semibold text-white",children:"ProAutoServices"})}),a.jsx("div",{className:"px-4 py-3 bg-gray-50",children:(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["Bonjour ",u]})}),a.jsx("div",{className:"flex-shrink-0",children:a.jsx(c.Z,{})}),a.jsx("nav",{className:"flex-1 px-4 py-4 space-y-1"}),a.jsx("div",{className:"p-4 border-t",children:a.jsx("button",{onClick:h,className:"w-full px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"D\xe9connexion"})})]})}),(0,a.jsxs)("div",{className:"lg:pl-64",children:[(0,a.jsxs)("div",{className:"sticky top-0 z-10 flex items-center justify-between h-16 px-4 bg-white shadow-sm",children:[a.jsx("button",{onClick:()=>d(!r),className:"p-2 text-gray-500 lg:hidden",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),a.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:s}),a.jsx("div",{className:"w-6 lg:hidden"})," "]}),a.jsx("main",{className:"p-4",children:e})]})]})}n=(d.then?(await d)():d)[0],r()}catch(e){r(e)}})},1915:(e,s,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(s,{Z:()=>u});var a=t(997),l=t(6689),i=t(5675),o=t.n(i),n=t(9008),c=t(3590),d=e([c]);function u({imageUrl:e,onUpload:s,onDelete:t,index:r}){let[i,d]=(0,l.useState)(!1),[u,m]=(0,l.useState)(null);(0,l.useEffect)(()=>{e&&m(null)},[e]);let h=async e=>{try{if(d(!0),!e.target.files||0===e.target.files.length)throw Error("Veuillez s\xe9lectionner une image");let t=e.target.files[0],r=t.name.split(".").pop()?.toLowerCase()||"";if(!["jpg","jpeg","png","gif"].includes(r))throw Error("Format de fichier non support\xe9. Utilisez JPG, PNG ou GIF");if(t.size>5242880)throw Error("La taille du fichier ne doit pas d\xe9passer 5MB");let a=`${Date.now()}-${Math.random().toString(36).substr(2,9)}.${r}`,l=new FileReader;l.onloadend=()=>{m(l.result)},l.readAsDataURL(t);let{error:i,data:o}=await n.O.storage.from("vehicle-photos").upload(a,t,{cacheControl:"3600",upsert:!1,contentType:`image/${"jpg"===r?"jpeg":r}`});if(i)throw console.error("Upload error details:",i),Error(i.message);if(o?.path){let{data:e}=n.O.storage.from("vehicle-photos").getPublicUrl(a);if(e?.publicUrl)s(e.publicUrl);else throw Error("Erreur lors de la r\xe9cup\xe9ration de l'URL publique")}else throw Error("Erreur lors du t\xe9l\xe9chargement du fichier")}catch(e){console.error("Upload error:",e),c.toast.error(e.message||"Erreur lors du t\xe9l\xe9chargement"),m(null)}finally{d(!1)}},x=async()=>{if(t)try{if(e){let s=e.split("/").pop();if(s){let{error:e}=await n.O.storage.from("vehicle-photos").remove([s]);if(e)throw console.error("Error deleting file:",e),Error("Erreur lors de la suppression du fichier")}}m(null),t()}catch(e){console.error("Error in handleDelete:",e),c.toast.error(e.message||"Erreur lors de la suppression de l'image")}},p=e||u;return a.jsx("div",{className:"relative w-full h-40 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400 transition-colors",children:p?(0,a.jsxs)(a.Fragment,{children:[a.jsx(o(),{src:p,alt:`Photo ${r+1}`,fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",className:"object-contain p-2 rounded-lg",unoptimized:null!==u,priority:0===r}),a.jsx("button",{onClick:x,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center shadow-md hover:bg-red-600 transition-colors z-10",type:"button",title:"Supprimer la photo",children:"\xd7"})]}):(0,a.jsxs)("label",{className:"flex flex-col items-center justify-center w-full h-full cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[a.jsx("svg",{className:"w-8 h-8 mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Photo ",r+1]}),i&&a.jsx("div",{className:"mt-2 text-sm text-blue-500",children:"Chargement..."})]}),a.jsx("input",{type:"file",className:"hidden",accept:"image/jpeg,image/png,image/gif",onChange:h,disabled:i})]})})}c=(d.then?(await d)():d)[0],r()}catch(e){r(e)}})},7318:(e,s,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(s,{Z:()=>d});var a=t(997),l=t(6689),i=t(8784),o=t.n(i),n=t(6201),c=e([n]);function d({onSave:e=()=>{},existingSignature:s}){let t=(0,l.useRef)(null),[r,i]=(0,l.useState)(!!s);return a.jsx("div",{className:"space-y-4",children:r&&s?(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("img",{src:s,alt:"Signature existante",className:"border rounded-lg p-2 bg-white"}),a.jsx("button",{onClick:()=>i(!1),className:"text-sm text-blue-600 hover:text-blue-800",children:"Modifier la signature"})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("div",{className:"border rounded-lg bg-white",children:a.jsx(o(),{ref:t,canvasProps:{className:"signature-canvas w-full h-40"}})}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[a.jsx("button",{onClick:()=>{t.current?.clear()},className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800",children:"Effacer"}),a.jsx("button",{onClick:()=>{if(t.current?.isEmpty()){n.default.error("Veuillez signer avant de sauvegarder");return}let s=t.current?.toDataURL();s&&e&&(e(s),n.default.success("Signature enregistr\xe9e"))},className:"px-3 py-1 text-sm text-white bg-blue-600 rounded hover:bg-blue-700",children:"Sauvegarder"})]})]})})}n=(c.then?(await c)():c)[0],r()}catch(e){r(e)}})},377:(e,s,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(s,{Z:()=>m});var a=t(997),l=t(6689),i=t(5641),o=t(9008),n=t(3590),c=t(7318),d=t(1915),u=e([i,n,c,d]);function m({vehicle:e,onClose:s,onSuccess:t}){let[r,u]=(0,l.useState)(!1),[m,h]=(0,l.useState)(""),[x,p]=(0,l.useState)([]),[f,b]=(0,l.useState)(e?.mechanics?.map(e=>e.toString())||[]),[g,j]=(0,l.useState)([]),{register:y,handleSubmit:v,setValue:w,formState:{errors:N}}=(0,i.useForm)({defaultValues:{client_name:e?.client_name||"",address:e?.address||"",phone:e?.phone||"",brand_model:e?.brand_model||"",mileage:e?.mileage||void 0,work_type:e?.work_type||"",parts_supplies:e?.parts_supplies||"",entry_date:e?.entry_date||"",exit_date:e?.exit_date||"",observations:e?.observations||"",registration_number:e?.registration_number||"",status:e?.status||"pending",mechanics:[]}});(0,l.useEffect)(()=>{k(),j([,,,,].fill("").map((s,t)=>e?.photos?.[t]||"")),e&&Object.entries(e).forEach(([e,s])=>{"mechanics"!==e&&"photos"!==e&&"client_signature"!==e&&w(e,s)})},[e,w]);let k=async()=>{try{let{data:e,error:s}=await o.O.from("mechanics").select("id, name").order("name");if(s)throw s;console.log("Mechanics fetched:",e),p(e||[])}catch(e){console.error("Error fetching mechanics:",e),n.toast.error("Erreur lors du chargement des m\xe9caniciens")}},_=(e,s)=>{let t=[...g];t[e]=s,j(t)},C=e=>{let s=[...g];s[e]="",j(s)},E=async s=>{try{u(!0);let r=f.map(e=>parseInt(e,10));console.log("Mechanic IDs before save:",r);let a={client_name:s.client_name,address:s.address,phone:s.phone,brand_model:s.brand_model,mileage:s.mileage,work_type:s.work_type,parts_supplies:s.parts_supplies,entry_date:s.entry_date,exit_date:s.exit_date,observations:s.observations,registration_number:s.registration_number,status:s.status,mechanics:r,client_signature:m,photos:g.filter(Boolean)};console.log("Vehicle data before cleanup:",a);let l=Object.fromEntries(Object.entries(a).filter(([e,s])=>Array.isArray(s)?s.length>0:void 0!==s&&""!==s&&null!==s));console.log("Clean data before save:",l),console.log("Update query:",{table:"vehicles",data:l,id:e?.id});let{data:i,error:c}=e?.id?await o.O.from("vehicles").update(l).eq("id",e.id):await o.O.from("vehicles").insert(l).select();if(c)throw console.error("Supabase error:",c),c;console.log("Update response:",i),n.toast.success(e?"V\xe9hicule modifi\xe9 avec succ\xe8s":"V\xe9hicule ajout\xe9 avec succ\xe8s"),t()}catch(s){console.error("Error saving vehicle:",s),n.toast.error(e?"Erreur lors de la modification du v\xe9hicule":"Erreur lors de l'ajout du v\xe9hicule")}finally{u(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:a.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:e?"Modifier le v\xe9hicule":"Ajouter un v\xe9hicule"}),(0,a.jsxs)("form",{onSubmit:v(E),className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom du client"}),a.jsx("input",{type:"text",...y("client_name",{required:"Ce champ est requis"}),className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"}),N.client_name&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.client_name.message})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Adresse"}),a.jsx("input",{type:"text",...y("address"),className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"T\xe9l\xe9phone"}),a.jsx("input",{type:"text",...y("phone",{required:"Ce champ est requis"}),className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"}),N.phone&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.phone.message})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Marque et Mod\xe8le"}),a.jsx("input",{type:"text",...y("brand_model",{required:"Ce champ est requis"}),className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"}),N.brand_model&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.brand_model.message})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kilom\xe9trage"}),a.jsx("input",{type:"number",...y("mileage"),className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Immatriculation"}),a.jsx("input",{type:"text",...y("registration_number",{required:"Ce champ est requis"}),className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"}),N.registration_number&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.registration_number.message})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type de travaux"}),a.jsx("input",{type:"text",...y("work_type",{required:"Ce champ est requis"}),className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"}),N.work_type&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.work_type.message})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pi\xe8ces et fournitures"}),a.jsx("textarea",{...y("parts_supplies"),rows:3,className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date d'entr\xe9e"}),a.jsx("input",{type:"date",...y("entry_date",{required:"Ce champ est requis"}),className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"}),N.entry_date&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:N.entry_date.message})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date de sortie pr\xe9vue"}),a.jsx("input",{type:"date",...y("exit_date"),className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Statut"}),(0,a.jsxs)("select",{...y("status"),className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2",children:[a.jsx("option",{value:"pending",children:"En attente"}),a.jsx("option",{value:"in_progress",children:"En cours"}),a.jsx("option",{value:"done",children:"Termin\xe9"}),a.jsx("option",{value:"validated",children:"Valid\xe9"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"M\xe9caniciens"}),a.jsx("select",{multiple:!0,value:f,onChange:e=>{let s=Array.from(e.target.selectedOptions,e=>e.value);b(s)},className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2",size:4,children:x.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Maintenez Ctrl (ou Cmd sur Mac) pour s\xe9lectionner plusieurs m\xe9caniciens"})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Observations"}),a.jsx("textarea",{...y("observations"),rows:3,className:"mt-1 block w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 focus:border-2"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Photos du v\xe9hicule"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:g.map((e,s)=>a.jsx(d.Z,{index:s,imageUrl:e,onUpload:e=>_(s,e),onDelete:()=>C(s)},`${s}-${e}`))}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Vous pouvez ajouter jusqu'\xe0 4 photos du v\xe9hicule"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Signature du client"}),a.jsx(c.Z,{existingSignature:m,onSave:e=>h(e)})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Annuler"}),a.jsx("button",{type:"submit",disabled:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:r?"Enregistrement...":e?"Modifier":"Ajouter"})]})]})]})})})}[i,n,c,d]=u.then?(await u)():u,r()}catch(e){r(e)}})},7553:(e,s,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.d(s,{Z:()=>d});var a=t(997),l=t(6689),i=t(9008),o=t(3590),n=t(377),c=e([o,n]);function d(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)(!0),[c,d]=(0,l.useState)(!1),[u,m]=(0,l.useState)(null),[h,x]=(0,l.useState)("");(0,l.useEffect)(()=>{p()},[]);let p=async()=>{try{let{data:e,error:t}=await i.O.from("vehicles").select("*").order("entry_date",{ascending:!1});if(t)throw t;let{data:r,error:a}=await i.O.from("mechanics").select("id, name");if(a)throw a;let l=new Map(r.map(e=>[e.id,e])),o=e.map(e=>({...e,mechanicsList:Array.isArray(e.mechanics)?e.mechanics.map(e=>l.get(e)?.name).filter(Boolean).join(", "):""}));s(o||[])}catch(e){console.error("Error fetching vehicles:",e),o.toast.error("Erreur lors du chargement des v\xe9hicules")}finally{r(!1)}},f=e.filter(e=>{let s=h.toLowerCase();return e.client_name?.toLowerCase().includes(s)||e.brand_model?.toLowerCase().includes(s)||e.registration_number?.toLowerCase().includes(s)||e.work_type?.toLowerCase().includes(s)}),b=e=>{m(e),d(!0)},g=async e=>{if(confirm("\xcates-vous s\xfbr de vouloir supprimer ce v\xe9hicule ?"))try{let{error:s}=await i.O.from("vehicles").delete().eq("id",e);if(s)throw s;o.toast.success("V\xe9hicule supprim\xe9 avec succ\xe8s"),p()}catch(e){console.error("Error deleting vehicle:",e),o.toast.error("Erreur lors de la suppression du v\xe9hicule")}},j=e=>{switch(e){case"pending":return"En attente";case"in_progress":return"En cours";case"done":return"Termin\xe9";case"validated":return"Valid\xe9";default:return e}},y=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"in_progress":return"bg-blue-100 text-blue-800";case"done":return"bg-green-100 text-green-800";case"validated":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return t?a.jsx("div",{children:"Chargement..."}):(0,a.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"sm:flex sm:items-center",children:[(0,a.jsxs)("div",{className:"sm:flex-auto",children:[a.jsx("h1",{className:"text-base font-semibold leading-6 text-gray-900",children:"Fiches V\xe9hicules"}),a.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"Liste des v\xe9hicules en r\xe9paration"})]}),a.jsx("div",{className:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none",children:a.jsx("button",{onClick:()=>{m(null),d(!0)},type:"button",className:"block rounded-md bg-blue-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600",children:"Ajouter une fiche"})})]}),a.jsx("div",{className:"mt-4",children:(0,a.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[a.jsx("input",{type:"text",value:h,onChange:e=>x(e.target.value),placeholder:"Rechercher par nom, mod\xe8le, immatriculation...",className:"block w-full rounded-md border-gray-300 pl-4 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:a.jsx("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})})]})}),a.jsx("div",{className:"mt-8 flow-root",children:a.jsx("div",{className:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8",children:a.jsx("div",{className:"inline-block min-w-full py-2 align-middle",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{children:[a.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8",children:"Client"}),a.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"V\xe9hicule"}),a.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Immatriculation"}),a.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Statut"}),a.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"M\xe9caniciens"}),a.jsx("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8",children:a.jsx("span",{className:"sr-only",children:"Actions"})})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:t?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"text-center py-4",children:"Chargement..."})}):0===f.length?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"text-center py-4 text-gray-500",children:h?"Aucun v\xe9hicule ne correspond \xe0 votre recherche":"Aucun v\xe9hicule enregistr\xe9"})}):f.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8",children:e.client_name}),a.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.brand_model}),a.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.registration_number||"-"}),a.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm",children:a.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ${y(e.status)}`,children:j(e.status)})}),a.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.mechanicsList||"-"}),(0,a.jsxs)("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6 lg:pr-8",children:[a.jsx("button",{onClick:()=>b(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Modifier"}),a.jsx("button",{onClick:()=>g(e.id),className:"text-red-600 hover:text-red-900",children:"Supprimer"})]})]},e.id))})]})})})}),c&&a.jsx(n.Z,{vehicle:u,onClose:()=>d(!1),onSuccess:()=>{d(!1),p()}})]})}[o,n]=c.then?(await c)():c,r()}catch(e){r(e)}})},9008:(e,s,t)=>{"use strict";t.d(s,{O:()=>r});let r=(0,t(2885).createClient)("https://pjxtjkmqgkbisgfleaps.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBqeHRqa21xZ2tiaXNnZmxlYXBzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYxOTAzMzAsImV4cCI6MjA1MTc2NjMzMH0.UjKK4kSJDapIRx0iJvdHiJZzMbi99tDx52FmSq4qyfE",{auth:{persistSession:!0,autoRefreshToken:!0}})},3900:(e,s,t)=>{"use strict";t.a(e,async(e,r)=>{try{t.r(s),t.d(s,{default:()=>o});var a=t(997);t(108);var l=t(3590);t(8819);var i=e([l]);function o({Component:e,pageProps:s}){return(0,a.jsxs)(a.Fragment,{children:[a.jsx(e,{...s}),a.jsx(l.ToastContainer,{})]})}l=(i.then?(await i)():i)[0],r()}catch(e){r(e)}})},108:()=>{}};